<%=: name | capitalize %> = require '../models/<%=: name %>'

# <%=: name | capitalize %> model's CRUD controller.
module.exports = 

  # Lists all <%=: name %>s
  index: (req, res) ->
    <%=: name | capitalize %>.find {}, (err, <%=: name %>s) ->
      res.format
        html: ()->
          res.render "<%=: name %>s/index", <%=: name %>s
        json: ()->
          res.send <%=: name %>s

  # new <%=: name %> 
  new: (req, res) ->
    <%=: name %> = new <%=: name | capitalize %>
      
  # Creates new <%=: name %> with data from `req.body`
  create: (req, res) ->
    <%=: name %> = new <%=: name | capitalize %> req.body
    <%=: name %>.save (err, <%=: name %>) ->
      if not err
        res.send <%=: name %>
        res.statusCode = 201
      else
        res.send err
        
  # Gets <%=: name %> by id
  show: (req, res) ->
    <%=: name | capitalize %>.findById req.params.<%=: name %>, (err, <%=: name %>) ->
      if not err
        res.send <%=: name %>
      else
        res.send err
             
  # Updates <%=: name %> with data from `req.body`
  update: (req, res) ->
    <%=: name | capitalize %>.findByIdAndUpdate req.params.<%=: name %>, {"$set":req.body}, (err, <%=: name %>) ->
      if not err
        res.send <%=: name %>
      else
        res.send err
    
  # Deletes <%=: name %> by id
  destroy: (req, res) ->
    <%=: name | capitalize %>.findByIdAndRemove req.params.<%=: name %>, (err) ->
      if not err
        res.send {}
      else
        res.send err
      
  
