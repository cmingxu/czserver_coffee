# 物品与装备系统 Props System #

[返回首页](./index.md)

## 功能说明：##

------------------------------------------------------------------
物品装备存放在3处地方：

** 1 玩家佩戴上。关于玩家佩戴的装备：每个角色可以带6中装备。分别是： ** 

- Helmet 头盔
- Armor 盔甲
- Weapon 武器
- Boots 长靴
- Gloves 手套
- Rings 戒指

** 2 玩家背包里的物品PackItems **

 - 数组[]
 - 头盔
 - 武器
 - 护甲
 - 药水（可叠加）
 - ......
 - position 摆放的位置？？？
 
** 3 商店里出售 **

-  根据玩家角色的等级，显示出当前等级相应的商品

------------------------------------------------------------------
### **装备属性：**

- ID
- strKey
- eType 类型
- level 当前等级
- pos 在背包的位置

		下列其它属性在配置文件里读取:
		- name 名称
		- desc 描述
		- quality 品质
		- maxLevel 最高等级
		- price_coin 价格铜钱
		- price_gold 价格元宝
		- HP 增加生命值
		- MP 增加魔法值
		- ATK 增加攻击力
		- DEF 增加防御力
	



### **消耗型物品属性：**

- ID
- strKey
- pos 在背包的位置

		下列其它属性在配置文件里读取:
		- name 名称
		- price_coin 价格铜钱
		- price_gold 价格元宝
		- HP 恢复生命值
		- MP 恢复魔法值

------------------------------------------------------------------
### 相关Models：###

|    名称   |         说明       
|-----------|-------------------
| character |玩家选定的角色


------------------------------------------------------------------


# API地址：

### `GET /props/shop_items` : 显示商店的商品列表

其实这个有客户端实现即可。

客户端存有一份关于商品数值的constData。
根据当前玩家的等级/职业，显示当前玩家可购买的商品（名称，说明，价格，追加的属性等等）

服务端也可以出一个API

### `GET /props` : 显示玩家背包的物品列表

背包的物品列表：

支持分页功能。


### `POST /props` : 购买商品
  
参数： str_key (本商品的惟一识别字符串)

- 根据str_key, 从ConstData数据里取得该装备的价格。检测玩家的资源是否足以购买。如果不足则返回错误。
- 检测装备是否可佩带型。（is_consumable===false）非消耗型。


### `Methods`：Controller里的公用方法

- AddPropToPack   往背包里添加物品

  - 如果是非消耗品，直接添加一条新纪录。
  - 如果是消耗品（药水，礼包等等），则检测当前背包里有没有同样str_key的记录，如果有，则数量+1；如果没有，则新添一条数量为1的记录。


- UsePropFromPack 使用背包里的物品

    - 如果是非消耗品，检测玩家佩戴的装备，与同类型（头盔，护腕等）的装备替换。
    - 如果是消耗品，那么物品数量-1，如果物品数量<=0则删除该物品记录。



### `PUT: /props/put_on` : 穿上装备、使用消耗型装备

在客户端双击背包的装备，或者拖拽背包的装备到角色的装备栏时执行。


- 检测玩家的物品栏里是否有这些装备。如果没有则返回错误。
- 检测装备是否可佩带型。
  - （is_consumable===true）消耗型。该装备数量--，如果数量为0则删除该装备。另外根据装备的strKey执行相应的操作。
  - （is_consumable===false）非消耗型。穿上该装备。如果角色身上有同类的装备，则提示是否替换？（在客户端完成这个检测？？？）
- 将该装备从玩家的物品栏记录里删除。

（调用PropsController里的公用方法，AddPropToPack, UsePropFromPack等）

### `PUT: /props/take_off ` : 脱下装备：

- 上述的操作反过来。


### `PUT: /props/update_pos` : 改变装备的排列位置


参数：装备的ID
参数：新的pos位置

- 检测，新的pos位置不得超过 (背包的容量-1)


### `POST: /props/unlock_space` : 解锁新的背包空格

背包空间的数量+1.

-------------------------------------------------------------------------------


## 其它


### `POST: /props/upgrade` : 装备的强化升级

逻辑跟个人升级的差不多。

------------------------------------------------------------------

[返回首页](./index.md)


